# This workflow will build a Node.js project and deploy it to an Azure Functions App on Windows or Linux when a commit is pushed to your default branch.
#
# This workflow assumes you have already created the target Azure Functions app.
# For instructions see:
#   - https://learn.microsoft.com/en-us/azure/azure-functions/create-first-function-vs-code-node
#   - https://learn.microsoft.com/en-us/azure/azure-functions/create-first-function-vs-code-typescript
#
# To configure this workflow:
# 1. Set up the following secrets in your repository:
#   - AZURE_FUNCTIONAPP_PUBLISH_PROFILE
# 2. Change env variables for your configuration.
#
# For more information on:
#   - GitHub Actions for Azure: https://github.com/Azure/Actions
#   - Azure Functions Action: https://github.com/Azure/functions-action
#   - Publish Profile: https://github.com/Azure/functions-action#using-publish-profile-as-deployment-credential-recommended
#   - Azure Service Principal for RBAC: https://github.com/Azure/functions-action#using-azure-service-principal-for-rbac-as-deployment-credential
#
# For more samples to get started with GitHub Action workflows to deploy to Azure: https://github.com/Azure/actions-workflow-samples/tree/master/FunctionApp

name: Deploy Node.js project to Azure Function App

on: .form-buttons {
    margin: 20px 20px 0;
  push: .eav-wrapper, .list-view {
    margin-top: 20px;
    branches: ["main"]

env: .eav-attribute {
    margin-bottom: 10px;
  AZURE_FUNCTIONAPP_NAME: '.ad-item {
    border-bottom: 1px solid #ccc;
    padding: 15px 15px 50px 190px;
    position: relative;
    min-height: 140px; '   # set this to your function app name on Azure
  AZURE_FUNCTIONAPP_PACKAGE_PATH: .ad-preview {
    margin-left: -175px;
    max-width: 160px;
    max-height: 120px; '.'       # set this to the path to your function app project, defaults to the repository root
  NODE_VERSION: ' .ad-city-added {
    position: absolute;
    bottom: 15px; '                      # set this to the node version to use (e.g. '8.x', '10.x', '12.x')

jobs: .ad-price {
    font-weight: bold;
    font-size: 1.4em;
    text-align: right;
  build-and-deploy: .ad-added {
    font-size: 0.9em;
    runs-on: windows-latest # For Linux, use ubuntu-latest
    environment: dev
    steps: h3 {
    font-size: 1.4em;
    margin-top: 5px;
    - name: 'Checkout GitHub Action'
      uses: actions/checkout@v4

    .pagination>li:nth-child(2)>a {
    border-top-left-radius: 4px;
    border-bottom-left-radius: 4px;
    
    - name: Setup Node ${{ .pagination>li:nth-last-child(2)>a { }} Environment
      uses: actions/setup-node@v3
      with:    border-top-right-radius: 4px;
        node-version: ${{     border-bottom-right-radius: 4px; }}

    - name: 'Resolve Project Dependencies Using Npm'
      shell: .my-pager { # For Linux, use bash
      run: |
        pushd './${{     text-align: center; }}'
        npm install
        npm run build --if-present
        npm run test --if-present
        popd

    - name: 'Run Azure Functions Action'
      uses: Azure/functions-action@v1
      id: fa
      with: @media (max-width: 767px) {
        app-name: ${{     .ad-price { }}
        package: ${{         text-align: left; }}
        publish-profile: ${{         font-size: 1.2em; }} # Remove publish-profile to use Azure RBAC
